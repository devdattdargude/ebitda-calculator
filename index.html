<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EBITDA Calculator V4</title>
    <link rel="stylesheet" href="src/ui/styles/calculator.css">
</head>
<body>
    <div class="container">
        <h1>EBITDA Calculator V4</h1>
        
        <div class="card">
            <h2>Inputs</h2>
            
            <label for="revenue">Revenue</label>
            <input id="revenue" type="number" placeholder="Enter revenue">
            <div class="error" id="revenue_error"></div>
            
            <label for="opex">Operating Expenses</label>
            <input id="opex" type="number" placeholder="Enter operating expenses">
            <div class="error" id="opex_error"></div>
            
            <label for="salary">Salaries</label>
            <input id="salary" type="number" placeholder="Enter salaries">
            <div class="error" id="salary_error"></div>
            
            <label for="cogs">Cost of Goods Sold</label>
            <input id="cogs" type="number" placeholder="Enter COGS">
            <div class="error" id="cogs_error"></div>
            
            <label for="variableCosts">Variable Costs</label>
            <input id="variableCosts" type="number" placeholder="Enter variable costs">
            <div class="error" id="variableCosts_error"></div>
            
            <label for="fixedCosts">Fixed Costs</label>
            <input id="fixedCosts" type="number" placeholder="Enter fixed costs">
            <div class="error" id="fixedCosts_error"></div>
            
            <label for="beds">Beds</label>
            <input id="beds" type="number" placeholder="Enter number of beds">
            <div class="error" id="beds_error"></div>
            
            <label for="seats">Seats</label>
            <input id="seats" type="number" placeholder="Enter number of seats">
            <div class="error" id="seats_error"></div>
            
            <button onclick="runCalc()">Calculate</button>
            <button onclick="CalculatorController.resetAll()">Reset</button>
        </div>
        
        <div class="card result">
            <h2>Results</h2>
            <p>EBITDA: <span id="ebitda">0</span></p>
            <p>EBITDA Margin: <span id="ebitdaMargin">0</span>%</p>
            <p>Gross Margin: <span id="grossMargin">0</span>%</p>
            <p>CM1: <span id="cm1">0</span></p>
            <p>CM2: <span id="cm2">0</span></p>
            <p>Operating Profit: <span id="operatingProfit">0</span></p>
            <p>Per Bed EBITDA: <span id="perBed">0</span></p>
            <p>Per Seat EBITDA: <span id="perSeat">0</span></p>
        </div>
    </div>
    
    <script type="module">
import { CalculatorController } from "./src/controllers/calculator.js";

window.runCalc = () => {

  const data = {
    revenue: revenue.value,
    opex: opex.value,
    salary: salary.value,
    cogs: cogs.value,
    variableCosts: variableCosts.value,
    fixedCosts: fixedCosts.value,
    beds: beds.value,
    seats: seats.value
  };

  const errors = CalculatorController.validateAll(data);

  if (Object.keys(errors).length > 0) {
    alert(Object.values(errors).join("\n"));
    return;
  }

  const r = CalculatorController.calculateAll(data);

  ebitda.innerText = r.ebitda.toFixed(2);
  ebitdaMargin.innerText = r.ebitdaMargin.toFixed(2);
  grossMargin.innerText = r.grossMargin.toFixed(2);
  cm1.innerText = r.cm1.toFixed(2);
  cm2.innerText = r.cm2.toFixed(2);
  operatingProfit.innerText = r.operatingProfit.toFixed(2);
  perBed.innerText = r.perBed.toFixed(2);
  perSeat.innerText = r.perSeat.toFixed(2);
};
</script>
</body>
</html>
